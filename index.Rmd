---
title: "ITN Courses"
subtitle: " "
output: html_document
---

<style type="text/css">
  body{
  text-align: justify;
  text-justify: inter-word;
}
</style>

### **Overview**

The following table contains a list of ITCR-funded courses.


```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
#devtools::install_github("tidyverse/googlesheets4")
library(DT)
library(here)
#library(googlesheets4)
library(tidyverse)
library(magrittr)
```

**Table keys:**
<div title="Table keys">
<img src="resources/images/githublogo.png"  height="30"> </img> = GitHub Source Material, <img src=resources/images/bookstack.png height="30"> </img> = Bookdown, <img src=resources/images/courseralogo.png height="30"> </img> = Coursera,<img src=resources/images/leanpublogo.png height="30"> </img> = Leanpub, &nbsp; <img src="resources/images/ITCRLogo.png" height="25"> </img> = ITCR Funded, <img src=resources/images/fhlogo.png height="30"></img> = Hutch Funded, <img src=resources/images/underconstruction.png height="30"></img> = Under Construction
</div>

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
# read in the google sheet
## set blank cells and "NA" strings to be NAs

#courses_sheet <- read_sheet("https://docs.google.com/spreadsheets/d/1TiNdu92hK-0FN8GbmWi_QbdUaX2yJF76yFt2oljm_qE/edit?usp=sharing", na = c("NA", ""))

courses_sheet <- read_csv(here("resources/CourseTable.csv"), na = c("NA", ""))

```

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
# remove the AI mini courses from the dataframe

courses_sheet <- courses_sheet[-which(courses_sheet$CourseName == "AI for Decision Makers: Exploring AI Possibilities"  | courses_sheet$CourseName == "AI for Decision Makers: Avoiding AI Harm"| courses_sheet$CourseName == "AI for Decision Makers: Determining AI Needs" | courses_sheet$CourseName == "AI for Decision Makers: Developing AI Policy"),]
```

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
# grab just software development courses
courses_software <- courses_sheet %>% filter(Category == "Software Development")
```

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
# grab just tools & resources courses
courses_toolresource <- courses_sheet %>% filter(Category == "Tools & Resources")
```

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
# grab just best practices courses
courses_bestpractice <- courses_sheet %>% filter(Category == "Best Practices")
```

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
prep_table <- function(inputdf){
  outputdfP1<- inputdf %>%
    filter(CurrentOrFuture == "Current") %>% #select just current classes
    mutate(CourseName = paste0("<b>", CourseName, "</b>")) %>% #mutate the name to be bolded
    mutate(CourseName =
             case_when(
               Funding == "ITN" ~ paste0(CourseName, '<br></br>', '<img src="resources/images/ITCRLogo.png" height="40"></img>'),
               Funding == "ITN; Hutch" ~ paste0(CourseName, '<br></br>', '<img src="resources/images/ITCRLogo.png" height="40"></img>', '<br></br>', '<img src="resources/images/fhlogo.png" height="40"></img>')
                       )
    ) %>%
    mutate(Links =
              case_when(
                (!is.na(LeanpubLink) & !is.na(CourseraLink)) ~ paste0('<a href="',GithubLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Github Source Material Link"> </div>','<img src="resources/images/githublogo.png"  height="30"> </img>', '</a>', '<br></br>',
                                                                      '<a href="',BookdownLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Bookdown Link"> </div>','<img src="resources/images/bookstack.png"  height="30"> </img>', '</a>', '<br></br>',
                                                                      '<a href="',CourseraLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Coursera Link"></div>','<img src="resources/images/courseralogo.png" height="30"> </img>', "</a>", '<br></br>',
                                                                      '<a href="',LeanpubLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Leanpub Link"> </div>','<img src="resources/images/leanpublogo.png"  height="30"> </img>', '</a>'
                                                                      ), #Fill in all 4 logos and links
                (!is.na(LeanpubLink) & is.na(CourseraLink)) ~ paste0('<a href="',GithubLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Github Source Material Link"> </div>','<img src="resources/images/githublogo.png"  height="30"> </img>', '</a>', '<br></br>',
                                                                      '<a href="',BookdownLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Bookdown Link"> </div>','<img src="resources/images/bookstack.png"  height="30"> </img>', '</a>', '<br></br>',
                                                                      '<a href="',LeanpubLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Leanpub Link"> </div>','<img src="resources/images/leanpublogo.png"  height="30"> </img>', '</a>'
                                                                     ), #Fill in Leanpub, Bookdown, and github logos and links
                (is.na(LeanpubLink) & !is.na(CourseraLink)) ~ paste0('<a href="',GithubLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Github Source Material Link"> </div>','<img src="resources/images/githublogo.png"  height="30"> </img>', '</a>', '<br></br>',
                                                                      '<a href="',BookdownLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Bookdown Link"> </div>','<img src="resources/images/bookstack.png"  height="30"> </img>', '</a>', '<br></br>',
                                                                      '<a href="',CourseraLink,'"style="color: #be3b2a"',' target="_blank"','<div title="Coursera Link"></div>','<img src="resources/images/courseralogo.png" height="30"> </img>', "</a>"
                                                                    ) #Fill in Coursera, Bookdown, and github logos and links
              )
           )

  outputdfP1 %<>% select(c(CourseName, Links, WebsiteDescription, BroadAudience))

  outputdfP2 <- inputdf %>%
    filter(CurrentOrFuture == "Future") %>% #select just future classes
    mutate(CourseName = paste0("<b>", CourseName, "</b>")) %>% #mutate the name to be bolded
    mutate(CourseName =
             case_when(
               Funding == "ITN" ~ paste0(CourseName, '<br></br>', '<img src="resources/images/ITCRLogo.png" height="40"></img>'),
               Funding == "ITN; Hutch" ~ paste0(CourseName, '<br></br>', '<img src="resources/images/ITCRLogo.png" height="40"></img>', '<br></br>', '<img src="resources/images/fhlogo.png" height="40"></img>')
                       )
    ) %>%
    mutate(Links = '<img src="resources/images/underconstruction.png" height="40"></img>'
             ) %>% select(c(CourseName, Links, WebsiteDescription, BroadAudience))

  outputdf <- rbind(outputdfP1, outputdfP2)  

  return(outputdf)  

  #name is first column (CourseName) with logos for funding (Funding)
  #links is second column unless it's still under construction, and then it's a cute icon about construction (GithubLink, `Bookdown link`, LeanpubLink, CourseraLink)
  #Description is third column (WebsiteDescription)
  #Concepts is fourth column (Concepts)
  #Audience is fifth column (BroadAudience to grab an icon?)
}
```

```{r,echo=FALSE,results='hide',message=FALSE, warning=FALSE}
setup_table <- function(inputdf, some_caption){
output_table <- inputdf %>%
  DT::datatable(
    style = 'default',
    width="100%",
    rownames = FALSE,
    escape = FALSE,
    caption = some_caption,
    filter = "top",
    options = list(scrollX = TRUE, autoWidth = TRUE, pageLength = 10,
                   scrollCollapse = TRUE, fillContainer = TRUE,
                   order = (list(0, 'asc')),
                   columnDefs = list(list(className = 'dt-center', targets = "_all")),
                   initComplete = JS(
                     "function(settings, json) {",
                     #"$('body').css({'font-family': 'Calibri'});",
                     "$(this.api().table().header()).css({'backgroundColor': '#3f546f'});",
                     "$(this.api().table().header()).css({'color': '#fff'});",
                     "}"))
  )
return(output_table)
}
```

```{r,echo=FALSE,message=FALSE, warning=FALSE}
#Display software table
software_table <- setup_table(prep_table(as_tibble(courses_software)), "Software Development Courses")
software_table
```

```{r,echo=FALSE,message=FALSE, warning=FALSE}
#Display tools & resources table
toolsresources_table <- setup_table(prep_table(as_tibble(courses_toolresource)), "Tools & Resources Courses")
toolsresources_table
```

```{r,echo=FALSE,message=FALSE, warning=FALSE}
#Display best practices table
bestpractices_table <- setup_table(prep_table(as_tibble(courses_bestpractice)), "Best Practices Courses")
bestpractices_table
```
